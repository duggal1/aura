2025-04-26 13:23:02.790 | INFO     | app.main:lifespan:14 - Starting application...
2025-04-26 13:23:02.795 | INFO     | app.logging_setup:start_metrics_server:76 - Prometheus metrics server started on port 8001
2025-04-26 13:23:02.797 | INFO     | app.cache:init_redis_pool:27 - Successfully connected to Redis at redis://localhost:6379/0
2025-04-26 13:23:05.902 | INFO     | app.emotion_pipeline:load_models:48 - Loaded emotion model labels: ['anger', 'disgust', 'fear', 'joy', 'neutral', 'sadness', 'surprise']
2025-04-26 13:23:05.937 | INFO     | app.llm_service:configure_genai:16 - Google GenAI client configured.
2025-04-26 13:23:05.938 | INFO     | app.main:lifespan:22 - Redis cache cleared on startup.
2025-04-26 13:23:05.938 | INFO     | app.main:lifespan:25 - Startup complete.
2025-04-26 13:23:12.871 | INFO     | app.main:chat_endpoint:74 - [ReqID: req_01f1853f] Chat request: 'i mean how are days going so far?  01:21 PM...'
2025-04-26 13:23:12.875 | INFO     | app.utils:wrapper:107 - Starting 'Advanced Emotion Analysis'...
2025-04-26 13:23:13.448 | INFO     | app.emotion_pipeline:map_emotions:69 - Raw distribution: {'surprise': 0.7458212971687317, 'neutral': 0.21050363779067993, 'sadness': 0.025109492242336273, 'joy': 0.00980065856128931, 'anger': 0.004462281242012978, 'fear': 0.0034656713251024485, 'disgust': 0.0008369662682525814}
2025-04-26 13:23:13.448 | INFO     | app.emotion_pipeline:map_emotions:70 - Mapped distribution: {'surprised': 0.74582, 'neutral': 0.2105, 'sad': 0.02511, 'happy': 0.0098, 'angry': 0.00446, 'fearful': 0.00347, 'disgusted': 0.00084}
2025-04-26 13:23:13.448 | ERROR    | app.emotion_pipeline:analyze_emotions:126 - Attempt 1/2 failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 13:23:13.448 | INFO     | app.emotion_pipeline:map_emotions:69 - Raw distribution: {'surprise': 0.7458212971687317, 'neutral': 0.21050363779067993, 'sadness': 0.025109492242336273, 'joy': 0.00980065856128931, 'anger': 0.004462281242012978, 'fear': 0.0034656713251024485, 'disgust': 0.0008369662682525814}
2025-04-26 13:23:13.449 | INFO     | app.emotion_pipeline:map_emotions:70 - Mapped distribution: {'surprised': 0.74582, 'neutral': 0.2105, 'sad': 0.02511, 'happy': 0.0098, 'angry': 0.00446, 'fearful': 0.00347, 'disgusted': 0.00084}
2025-04-26 13:23:13.449 | ERROR    | app.emotion_pipeline:analyze_emotions:126 - Attempt 2/2 failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 13:23:13.449 | WARNING  | app.emotion_pipeline:analyze_emotions:128 - Max attempts reached. Falling back to neutral.
2025-04-26 13:23:13.449 | INFO     | app.utils:wrapper:117 - 'Advanced Emotion Analysis' completed successfully in 0.5745 seconds.
2025-04-26 13:23:13.450 | WARNING  | app.main:chat_endpoint:97 - [ReqID: req_01f1853f] Low-confidence emotion detected.
2025-04-26 13:23:13.450 | INFO     | app.utils:wrapper:107 - Starting 'LLM Emotion + Response'...
2025-04-26 13:23:16.107 | INFO     | app.utils:wrapper:107 - Starting 'Advanced Emotion Analysis'...
2025-04-26 13:23:16.200 | INFO     | app.emotion_pipeline:map_emotions:69 - Raw distribution: {'neutral': 0.500194787979126, 'surprise': 0.42519402503967285, 'joy': 0.050139740109443665, 'sadness': 0.01602230593562126, 'anger': 0.005401320289820433, 'disgust': 0.001826739520765841, 'fear': 0.0012210255954414606}
2025-04-26 13:23:16.200 | INFO     | app.emotion_pipeline:map_emotions:70 - Mapped distribution: {'neutral': 0.50019, 'surprised': 0.42519, 'happy': 0.05014, 'sad': 0.01602, 'angry': 0.0054, 'disgusted': 0.00183, 'fearful': 0.00122}
2025-04-26 13:23:16.201 | ERROR    | app.emotion_pipeline:analyze_emotions:126 - Attempt 1/2 failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 13:23:16.201 | INFO     | app.emotion_pipeline:map_emotions:69 - Raw distribution: {'neutral': 0.500194787979126, 'surprise': 0.42519402503967285, 'joy': 0.050139740109443665, 'sadness': 0.01602230593562126, 'anger': 0.005401320289820433, 'disgust': 0.001826739520765841, 'fear': 0.0012210255954414606}
2025-04-26 13:23:16.201 | INFO     | app.emotion_pipeline:map_emotions:70 - Mapped distribution: {'neutral': 0.50019, 'surprised': 0.42519, 'happy': 0.05014, 'sad': 0.01602, 'angry': 0.0054, 'disgusted': 0.00183, 'fearful': 0.00122}
2025-04-26 13:23:16.201 | ERROR    | app.emotion_pipeline:analyze_emotions:126 - Attempt 2/2 failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 13:23:16.201 | WARNING  | app.emotion_pipeline:analyze_emotions:128 - Max attempts reached. Falling back to neutral.
2025-04-26 13:23:16.202 | INFO     | app.utils:wrapper:117 - 'Advanced Emotion Analysis' completed successfully in 0.0948 seconds.
2025-04-26 13:23:16.202 | INFO     | app.llm_service:validate_response:44 - Response validated: matches expected emotion neutral
2025-04-26 13:23:16.202 | INFO     | app.utils:wrapper:117 - 'LLM Emotion + Response' completed successfully in 2.7526 seconds.
2025-04-26 13:23:16.202 | INFO     | app.main:chat_endpoint:127 - [ReqID: req_01f1853f] Skipped caching due to low-confidence emotion (score: 0.5).
2025-04-26 13:23:16.203 | INFO     | app.main:chat_endpoint:134 - [ReqID: req_01f1853f] Processed in 3.3319s.
2025-04-26 13:24:57.845 | INFO     | app.main:chat_endpoint:74 - [ReqID: req_082b9caf] Chat request: 'im feeling lonely as fuck...'
2025-04-26 13:24:57.851 | INFO     | app.utils:wrapper:107 - Starting 'Advanced Emotion Analysis'...
2025-04-26 13:24:58.979 | INFO     | app.emotion_pipeline:map_emotions:69 - Raw distribution: {'sadness': 0.9935387969017029, 'neutral': 0.001780133112333715, 'fear': 0.0012652918230742216, 'surprise': 0.0010263320291414857, 'anger': 0.0009730298188515007, 'disgust': 0.0007705657626502216, 'joy': 0.0006459194119088352}
2025-04-26 13:24:58.979 | INFO     | app.emotion_pipeline:map_emotions:70 - Mapped distribution: {'sad': 0.99354, 'neutral': 0.00178, 'fearful': 0.00127, 'surprised': 0.00103, 'angry': 0.00097, 'disgusted': 0.00077, 'happy': 0.00065}
2025-04-26 13:24:58.979 | ERROR    | app.emotion_pipeline:analyze_emotions:126 - Attempt 1/2 failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 13:24:58.979 | INFO     | app.emotion_pipeline:map_emotions:69 - Raw distribution: {'sadness': 0.9935387969017029, 'neutral': 0.001780133112333715, 'fear': 0.0012652918230742216, 'surprise': 0.0010263320291414857, 'anger': 0.0009730298188515007, 'disgust': 0.0007705657626502216, 'joy': 0.0006459194119088352}
2025-04-26 13:24:58.980 | INFO     | app.emotion_pipeline:map_emotions:70 - Mapped distribution: {'sad': 0.99354, 'neutral': 0.00178, 'fearful': 0.00127, 'surprised': 0.00103, 'angry': 0.00097, 'disgusted': 0.00077, 'happy': 0.00065}
2025-04-26 13:24:58.980 | ERROR    | app.emotion_pipeline:analyze_emotions:126 - Attempt 2/2 failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 13:24:58.980 | WARNING  | app.emotion_pipeline:analyze_emotions:128 - Max attempts reached. Falling back to neutral.
2025-04-26 13:24:58.980 | INFO     | app.utils:wrapper:117 - 'Advanced Emotion Analysis' completed successfully in 1.1297 seconds.
2025-04-26 13:24:58.981 | WARNING  | app.main:chat_endpoint:97 - [ReqID: req_082b9caf] Low-confidence emotion detected.
2025-04-26 13:24:58.981 | INFO     | app.utils:wrapper:107 - Starting 'LLM Emotion + Response'...
2025-04-26 13:25:00.454 | INFO     | app.utils:wrapper:107 - Starting 'Advanced Emotion Analysis'...
2025-04-26 13:25:00.546 | INFO     | app.emotion_pipeline:map_emotions:69 - Raw distribution: {'sadness': 0.9905146360397339, 'neutral': 0.003923861309885979, 'surprise': 0.002080427249893546, 'disgust': 0.0010597765212878585, 'joy': 0.0009011051733978093, 'anger': 0.0007675517117604613, 'fear': 0.0007526089902967215}
2025-04-26 13:25:00.546 | INFO     | app.emotion_pipeline:map_emotions:70 - Mapped distribution: {'sad': 0.99051, 'neutral': 0.00392, 'surprised': 0.00208, 'disgusted': 0.00106, 'happy': 0.0009, 'angry': 0.00077, 'fearful': 0.00075}
2025-04-26 13:25:00.547 | ERROR    | app.emotion_pipeline:analyze_emotions:126 - Attempt 1/2 failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 13:25:00.547 | INFO     | app.emotion_pipeline:map_emotions:69 - Raw distribution: {'sadness': 0.9905146360397339, 'neutral': 0.003923861309885979, 'surprise': 0.002080427249893546, 'disgust': 0.0010597765212878585, 'joy': 0.0009011051733978093, 'anger': 0.0007675517117604613, 'fear': 0.0007526089902967215}
2025-04-26 13:25:00.547 | INFO     | app.emotion_pipeline:map_emotions:70 - Mapped distribution: {'sad': 0.99051, 'neutral': 0.00392, 'surprised': 0.00208, 'disgusted': 0.00106, 'happy': 0.0009, 'angry': 0.00077, 'fearful': 0.00075}
2025-04-26 13:25:00.547 | ERROR    | app.emotion_pipeline:analyze_emotions:126 - Attempt 2/2 failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 13:25:00.547 | WARNING  | app.emotion_pipeline:analyze_emotions:128 - Max attempts reached. Falling back to neutral.
2025-04-26 13:25:00.548 | INFO     | app.utils:wrapper:117 - 'Advanced Emotion Analysis' completed successfully in 0.0937 seconds.
2025-04-26 13:25:00.548 | INFO     | app.llm_service:validate_response:44 - Response validated: matches expected emotion neutral
2025-04-26 13:25:00.548 | INFO     | app.utils:wrapper:117 - 'LLM Emotion + Response' completed successfully in 1.5672 seconds.
2025-04-26 13:25:00.548 | INFO     | app.main:chat_endpoint:127 - [ReqID: req_082b9caf] Skipped caching due to low-confidence emotion (score: 0.5).
2025-04-26 13:25:00.548 | INFO     | app.main:chat_endpoint:134 - [ReqID: req_082b9caf] Processed in 2.7033s.
2025-04-26 13:25:32.689 | INFO     | app.main:lifespan:27 - Shutting down...
2025-04-26 13:25:32.692 | ERROR    | app.cache:close_redis_pool:49 - Error closing Redis connection pool: 'Redis' object has no attribute 'wait_closed'
