2025-04-26 12:54:07.147 | INFO     | app.main:lifespan:14 - Starting application...
2025-04-26 12:54:07.150 | INFO     | app.logging_setup:start_metrics_server:76 - Prometheus metrics server started on port 8001
2025-04-26 12:54:07.152 | INFO     | app.cache:init_redis_pool:27 - Successfully connected to Redis at redis://localhost:6379/0
2025-04-26 12:54:11.256 | INFO     | app.emotion_pipeline:load_models:48 - Loaded emotion model labels: ['anger', 'disgust', 'fear', 'joy', 'neutral', 'sadness', 'surprise']
2025-04-26 12:54:11.291 | INFO     | app.llm_service:configure_genai:16 - Google GenAI client configured.
2025-04-26 12:54:11.297 | INFO     | app.main:lifespan:22 - Redis cache cleared on startup.
2025-04-26 12:54:11.297 | INFO     | app.main:lifespan:25 - Startup complete.
2025-04-26 12:54:26.764 | INFO     | app.main:chat_endpoint:74 - [ReqID: req_a010f6ef] Chat request: 'mean how are days going so far?...'
2025-04-26 12:54:26.766 | INFO     | app.utils:wrapper:107 - Starting 'Advanced Emotion Analysis'...
2025-04-26 12:54:27.393 | INFO     | app.emotion_pipeline:map_emotions:67 - Raw distribution: {'surprise': 0.8465103507041931, 'neutral': 0.12128028273582458, 'sadness': 0.014949826523661613, 'joy': 0.0075832842849195, 'anger': 0.005745152942836285, 'disgust': 0.002100571757182479, 'fear': 0.0018305114936083555}
2025-04-26 12:54:27.393 | INFO     | app.emotion_pipeline:map_emotions:68 - Mapped distribution: {'surprised': 0.84651, 'neutral': 0.12128, 'sad': 0.01495, 'happy': 0.00758, 'angry': 0.00575, 'disgusted': 0.0021, 'fearful': 0.00183}
2025-04-26 12:54:27.394 | ERROR    | app.emotion_pipeline:analyze_emotions:124 - Failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 12:54:27.394 | INFO     | app.utils:wrapper:117 - 'Advanced Emotion Analysis' completed successfully in 0.6281 seconds.
2025-04-26 12:54:27.394 | WARNING  | app.main:chat_endpoint:97 - [ReqID: req_a010f6ef] Low-confidence emotion detected.
2025-04-26 12:54:27.394 | INFO     | app.utils:wrapper:107 - Starting 'LLM Emotion + Response'...
2025-04-26 12:54:30.202 | INFO     | app.utils:wrapper:107 - Starting 'Advanced Emotion Analysis'...
2025-04-26 12:54:30.654 | INFO     | app.emotion_pipeline:map_emotions:67 - Raw distribution: {'joy': 0.7833994030952454, 'neutral': 0.09155220538377762, 'surprise': 0.08747012913227081, 'sadness': 0.030153753235936165, 'anger': 0.004444407299160957, 'disgust': 0.001879397314041853, 'fear': 0.0011008036090061069}
2025-04-26 12:54:30.654 | INFO     | app.emotion_pipeline:map_emotions:68 - Mapped distribution: {'happy': 0.7834, 'neutral': 0.09155, 'surprised': 0.08747, 'sad': 0.03015, 'angry': 0.00444, 'disgusted': 0.00188, 'fearful': 0.0011}
2025-04-26 12:54:30.655 | ERROR    | app.emotion_pipeline:analyze_emotions:124 - Failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 12:54:30.655 | INFO     | app.utils:wrapper:117 - 'Advanced Emotion Analysis' completed successfully in 0.4527 seconds.
2025-04-26 12:54:30.655 | INFO     | app.llm_service:validate_response:44 - Response validated: matches expected emotion neutral
2025-04-26 12:54:30.655 | INFO     | app.utils:wrapper:117 - 'LLM Emotion + Response' completed successfully in 3.2611 seconds.
2025-04-26 12:54:30.656 | INFO     | app.main:chat_endpoint:127 - [ReqID: req_a010f6ef] Skipped caching due to low-confidence emotion (score: 0.5).
2025-04-26 12:54:30.656 | INFO     | app.main:chat_endpoint:134 - [ReqID: req_a010f6ef] Processed in 3.8920s.
2025-04-26 13:20:28.816 | INFO     | app.main:lifespan:27 - Shutting down...
2025-04-26 13:20:28.821 | ERROR    | app.cache:close_redis_pool:49 - Error closing Redis connection pool: 'Redis' object has no attribute 'wait_closed'
2025-04-26 13:20:28.822 | INFO     | app.main:lifespan:29 - Shutdown complete.
