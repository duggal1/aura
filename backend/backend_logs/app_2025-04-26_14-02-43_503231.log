2025-04-26 14:02:51.916 | INFO     | app.main:lifespan:14 - Starting application...
2025-04-26 14:02:51.926 | INFO     | app.logging_setup:start_metrics_server:76 - Prometheus metrics server started on port 8001
2025-04-26 14:02:51.932 | INFO     | app.cache:init_redis_pool:31 - Successfully connected to Redis at redis://localhost:6379/0
2025-04-26 14:02:51.932 | INFO     | app.emotion_pipeline:load_models:87 - Device set to use cpu
2025-04-26 14:02:53.486 | INFO     | app.emotion_pipeline:load_models:101 - Loaded emotion model: j-hartmann/emotion-english-distilroberta-base
2025-04-26 14:02:53.486 | INFO     | app.emotion_pipeline:load_models:104 - Loaded emotion model labels from config: ['anger', 'disgust', 'fear', 'joy', 'neutral', 'sadness', 'surprise']
2025-04-26 14:02:54.121 | INFO     | app.emotion_pipeline:load_models:119 - Loaded sentiment model
2025-04-26 14:02:55.644 | INFO     | app.emotion_pipeline:load_models:135 - Loaded sarcasm model: jkhan447/sarcasm-detection-RoBerta-base-POS
2025-04-26 14:02:55.645 | INFO     | app.emotion_pipeline:load_models:137 - Loaded sarcasm model labels from config: ['LABEL_0', 'LABEL_1']
2025-04-26 14:02:55.678 | INFO     | app.llm_service:configure_genai:16 - Google GenAI client configured.
2025-04-26 14:02:55.679 | INFO     | app.main:lifespan:22 - Redis cache cleared on startup.
2025-04-26 14:02:55.679 | INFO     | app.main:lifespan:25 - Startup complete.
2025-04-26 14:02:55.680 | INFO     | app.main:chat_endpoint:74 - [ReqID: req_4d67b77e] Chat request: 'im feeling lonely as fuck...'
2025-04-26 14:02:55.681 | INFO     | app.utils:wrapper:107 - Starting 'Advanced Emotion Analysis'...
2025-04-26 14:02:55.819 | INFO     | app.emotion_pipeline:map_emotions:75 - Raw distribution: {'anger': 0.0009730298188515007, 'disgust': 0.0007705657626502216, 'fear': 0.0012652918230742216, 'joy': 0.0006459194119088352, 'neutral': 0.001780133112333715, 'sadness': 0.9935387969017029, 'surprise': 0.0010263320291414857}
2025-04-26 14:02:55.819 | INFO     | app.emotion_pipeline:map_emotions:76 - Mapped distribution: {'angry': 0.00097, 'disgusted': 0.00077, 'fearful': 0.00127, 'happy': 0.00065, 'neutral': 0.00178, 'sad': 0.99354, 'surprised': 0.00103}
2025-04-26 14:02:55.820 | ERROR    | app.emotion_pipeline:analyze_emotions:312 - Unexpected error creating EmotionAnalysisResult: Incorrect label names
2025-04-26 14:02:55.820 | WARNING  | app.emotion_pipeline:analyze_emotions:313 - Returning neutral fallback due to unexpected processing error.
2025-04-26 14:02:55.821 | INFO     | app.utils:wrapper:117 - 'Advanced Emotion Analysis' completed successfully in 0.1402 seconds.
2025-04-26 14:02:55.821 | WARNING  | app.main:chat_endpoint:97 - [ReqID: req_4d67b77e] Low-confidence emotion detected.
2025-04-26 14:02:55.821 | INFO     | app.utils:wrapper:107 - Starting 'LLM Emotion + Response'...
2025-04-26 14:02:58.675 | INFO     | app.utils:wrapper:107 - Starting 'Advanced Emotion Analysis'...
2025-04-26 14:02:58.770 | INFO     | app.emotion_pipeline:map_emotions:75 - Raw distribution: {'anger': 0.001202319865114987, 'disgust': 0.0007130951853469014, 'fear': 0.0018067058408632874, 'joy': 0.0006381810526363552, 'neutral': 0.002106113126501441, 'sadness': 0.9924116730690002, 'surprise': 0.001121854642406106}
2025-04-26 14:02:58.770 | INFO     | app.emotion_pipeline:map_emotions:76 - Mapped distribution: {'angry': 0.0012, 'disgusted': 0.00071, 'fearful': 0.00181, 'happy': 0.00064, 'neutral': 0.00211, 'sad': 0.99241, 'surprised': 0.00112}
2025-04-26 14:02:58.770 | ERROR    | app.emotion_pipeline:analyze_emotions:312 - Unexpected error creating EmotionAnalysisResult: Incorrect label names
2025-04-26 14:02:58.771 | WARNING  | app.emotion_pipeline:analyze_emotions:313 - Returning neutral fallback due to unexpected processing error.
2025-04-26 14:02:58.772 | INFO     | app.utils:wrapper:117 - 'Advanced Emotion Analysis' completed successfully in 0.0972 seconds.
2025-04-26 14:02:58.772 | INFO     | app.llm_service:validate_response:44 - Response validated: matches expected emotion neutral
2025-04-26 14:02:58.772 | INFO     | app.utils:wrapper:117 - 'LLM Emotion + Response' completed successfully in 2.9511 seconds.
2025-04-26 14:02:58.773 | INFO     | app.main:chat_endpoint:127 - [ReqID: req_4d67b77e] Skipped caching due to low-confidence emotion (score: 0.5).
2025-04-26 14:02:58.773 | INFO     | app.main:chat_endpoint:134 - [ReqID: req_4d67b77e] Processed in 3.0926s.
2025-04-26 14:07:09.985 | INFO     | app.main:lifespan:27 - Shutting down...
2025-04-26 14:07:09.990 | INFO     | app.cache:close_redis_pool:58 - Redis connection pool closed.
2025-04-26 14:07:09.991 | INFO     | app.main:lifespan:29 - Shutdown complete.
