2025-04-26 13:47:19.870 | INFO     | app.main:lifespan:14 - Starting application...
2025-04-26 13:47:19.881 | INFO     | app.logging_setup:start_metrics_server:76 - Prometheus metrics server started on port 8001
2025-04-26 13:47:19.887 | INFO     | app.cache:init_redis_pool:27 - Successfully connected to Redis at redis://localhost:6379/0
2025-04-26 13:47:21.751 | INFO     | app.emotion_pipeline:load_models:69 - Loaded emotion model: j-hartmann/emotion-english-distilroberta-base
2025-04-26 13:47:22.433 | INFO     | app.emotion_pipeline:load_models:80 - Loaded sentiment model
2025-04-26 13:47:24.529 | INFO     | app.emotion_pipeline:load_models:94 - Loaded sarcasm model: jkhan447/sarcasm-detection-RoBerta-base-POS
2025-04-26 13:47:24.530 | INFO     | app.emotion_pipeline:load_models:100 - Loaded emotion model labels: ['anger', 'disgust', 'fear', 'joy', 'neutral', 'sadness', 'surprise']
2025-04-26 13:47:24.570 | INFO     | app.llm_service:configure_genai:16 - Google GenAI client configured.
2025-04-26 13:47:24.574 | INFO     | app.main:lifespan:22 - Redis cache cleared on startup.
2025-04-26 13:47:24.575 | INFO     | app.main:lifespan:25 - Startup complete.
2025-04-26 13:47:24.580 | INFO     | app.main:chat_endpoint:74 - [ReqID: req_7bb93f75] Chat request: 'im feeling lonely as fuck...'
2025-04-26 13:47:24.582 | INFO     | app.utils:wrapper:107 - Starting 'Advanced Emotion Analysis'...
2025-04-26 13:47:24.725 | WARNING  | app.schemas:ensure_valid_labels:17 - Ignoring invalid emotion labels: {'sadness'}
2025-04-26 13:47:24.725 | WARNING  | app.schemas:ensure_valid_labels:19 - No valid emotions found; defaulting to neutral.
2025-04-26 13:47:24.725 | INFO     | app.emotion_pipeline:map_emotions:48 - Raw distribution: {'sadness': 0.9935387969017029}
2025-04-26 13:47:24.725 | INFO     | app.emotion_pipeline:map_emotions:49 - Mapped distribution: {'sad': 1.0}
2025-04-26 13:47:24.725 | ERROR    | app.emotion_pipeline:analyze_emotions:162 - Failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 13:47:24.725 | WARNING  | app.emotion_pipeline:analyze_emotions:163 - Returning neutral fallback due to processing error.
2025-04-26 13:47:24.726 | INFO     | app.utils:wrapper:117 - 'Advanced Emotion Analysis' completed successfully in 0.1444 seconds.
2025-04-26 13:47:24.727 | WARNING  | app.main:chat_endpoint:97 - [ReqID: req_7bb93f75] Low-confidence emotion detected.
2025-04-26 13:47:24.727 | INFO     | app.utils:wrapper:107 - Starting 'LLM Emotion + Response'...
2025-04-26 13:47:27.945 | INFO     | app.utils:wrapper:107 - Starting 'Advanced Emotion Analysis'...
2025-04-26 13:47:28.047 | WARNING  | app.schemas:ensure_valid_labels:17 - Ignoring invalid emotion labels: {'sadness'}
2025-04-26 13:47:28.047 | WARNING  | app.schemas:ensure_valid_labels:19 - No valid emotions found; defaulting to neutral.
2025-04-26 13:47:28.047 | INFO     | app.emotion_pipeline:map_emotions:48 - Raw distribution: {'sadness': 0.9920271039009094}
2025-04-26 13:47:28.047 | INFO     | app.emotion_pipeline:map_emotions:49 - Mapped distribution: {'sad': 1.0}
2025-04-26 13:47:28.048 | ERROR    | app.emotion_pipeline:analyze_emotions:162 - Failed to create EmotionAnalysisResult: Incorrect label names
2025-04-26 13:47:28.048 | WARNING  | app.emotion_pipeline:analyze_emotions:163 - Returning neutral fallback due to processing error.
2025-04-26 13:47:28.048 | INFO     | app.utils:wrapper:117 - 'Advanced Emotion Analysis' completed successfully in 0.1031 seconds.
2025-04-26 13:47:28.049 | INFO     | app.llm_service:validate_response:44 - Response validated: matches expected emotion neutral
2025-04-26 13:47:28.049 | INFO     | app.utils:wrapper:117 - 'LLM Emotion + Response' completed successfully in 3.3222 seconds.
2025-04-26 13:47:28.049 | INFO     | app.main:chat_endpoint:127 - [ReqID: req_7bb93f75] Skipped caching due to low-confidence emotion (score: 0.5).
2025-04-26 13:47:28.049 | INFO     | app.main:chat_endpoint:134 - [ReqID: req_7bb93f75] Processed in 3.4690s.
2025-04-26 13:49:50.708 | INFO     | app.main:lifespan:27 - Shutting down...
2025-04-26 13:49:50.715 | ERROR    | app.cache:close_redis_pool:49 - Error closing Redis connection pool: 'Redis' object has no attribute 'wait_closed'
2025-04-26 13:49:50.716 | INFO     | app.main:lifespan:29 - Shutdown complete.
